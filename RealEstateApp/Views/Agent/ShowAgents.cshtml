@model List<AgentViewModel>

@{
    ViewData["Title"] = "Agentes";
    Layout = ViewData["Layout"] as string ?? "_LayoutAnonymous";
}

<header class="position-relative hero-image overflow-hidden text-center text-white" style="height: 300px;">
    <img src="https://plus.unsplash.com/premium_photo-1661329955912-ebc4279f3b21?fm=jpg&q=60&w=3000&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8YnVzaW5lc3MlMjBoYW5kc2hha2V8ZW58MHx8MHx8fDA%3D" alt="Fondo de Agentes" class="w-100 h-100 object-fit-cover position-absolute top-0 start-0" />
    <div class="position-absolute w-100 h-100 top-0 start-0 bg-black opacity-50"></div>
    <div class="d-flex align-items-center justify-content-center h-100 position-relative z-1">
        <h1 class="display-4 fw-bold text-shadow">Nuestros Agentes</h1>
    </div>
</header>

<div class="container my-5">
    <div class="row justify-content-center mb-4">
        <div class="col-md-8">
            <div class="input-group">
                <span class="input-group-text bg-transparent border-end-0"><i class="bi bi-search"></i></span>
                <input type="text" id="agent-name" class="form-control border-start-0" placeholder="Buscar por nombre de agente..." />
            </div>
        </div>
    </div>

    <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-4" id="agents-container">
        @foreach (var agent in Model)
        {
            <div class="col agent-card" data-name="@(agent.Name.ToLower())">
                <div class="card h-100 shadow-sm border-0">
                    <div class="ratio ratio-1x1 position-relative">
                        <img src="@Url.Content("/" + agent.Image)" class="card-img-top object-fit-cover rounded-circle position-absolute top-50 start-50 translate-middle" alt="@agent.Name" style="width:150px; height:150px; border: 4px solid #f8f9fa;">
                    </div>
                    <div class="card-body d-flex flex-column text-center pt-5">
                        <h5 class="card-title fw-bold mt-2">@agent.Name</h5>
                        <p class="card-text text-muted mb-0"><small>@agent.Email</small></p>
                        <p class="card-text"><small>Propiedades activas: <strong class="text-primary">@(agent.Properties?.Count() ?? 0)</strong></small></p>
                    </div>
                </div>
            </div>
        }
    </div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', function () {
        const searchInput = document.getElementById("agent-name");
        const agentCards = document.querySelectorAll(".agent-card");

        searchInput.addEventListener("keyup", function () {
            const filter = this.value.toLowerCase();
            agentCards.forEach(card => {
                const name = card.dataset.name;
                if (name.includes(filter)) {
                    card.style.display = "block";
                } else {
                    card.style.display = "none";
                }
            });
        });
    });
</script>